<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
    <title>User Interface</title>
    <link rel="stylesheet" type="text/css" href="styles/main.css">
    <script src="scripts/topButton.js"></script>
    <button onclick="topFunction()" id="topButton" title="Back to top">Back to top</button>
</head>
<body id="_top">

<center><a href="https://cliniface.org"><img src="images/cface.svg" alt="Cliniface Logo" style="width:27%;"/></a></center>
<center><h1>User Interface</h1></center>
<center><a href="index.html">Back to contents</a></center>
<hr>

<h2 "ui_main">Main Window</h2>
<p>Upon starting Cliniface, the application's main interface is displayed. The interface is divided into the regions demarcated by red rectangles in the image below. Each of the regions is described below in more detail. Depending on the state and configuration of the application, some of these actions may be greyed out meaning that they are currently unavailable. Upon starting Cliniface most functionality is unavailable until a model is loaded. Models can be loaded by selecting the <em>Open</em> action from the <a href="#file_menu">File</a> menu (or clicking the corresponding toolbar icon directly underneath the <em>File</em> menu), or by dragging a 3D model file onto the main viewer of the interface.
</p>
<p>The layout of the interface is shown below, with the indented sections being menus or submenus. Each of the links will take you to more information about the corresponding menu / interface element.
</p>
<ul>
    <li><a href="#ui_menus">Main Menubar</a></li>
    <ul>
        <li><a href="#file_menu">File</a></li>
        <li><a href="#view_menu">View</a></li>
        <ul>
            <li><a href="#scalar_mapping">Scalar Mapping</a></li>
        </ul>
        <li><a href="#camera_menu">Camera</a></li>
        <li><a href="#transform_menu">Transform</a></li>
        <li><a href="#geometry_menu">Geometry</a></li>
        <li><a href="#metrics_menu">Metrics</a></li>
        <li><a href="#help_menu">Help</a></li>
    </ul>
    <li><a href="#main_toolbar">Main Toolbar</a></li>
    <li><a href="#vis_toolbar">Visualisations Toolbar</a></li>
    <li><a href="#main_viewer">Main Viewer</a></li>
    <ul>
        <li><a href="#context_menu">Context Menu (right-click menu)</a></li>
    </ul>
    <li><a href="#main_viewer">Main Viewer</a></li>
    <li><a href="#selection">Model / View Selection</a></li>
    <li><a href="#status_bar">Status Bar</a></li>
</ul>

<center><img src="images/ui_main_regions.png"/></center>

<h2 id="ui_menus">Main Menubar</h2>
<p>Most functionality is accessible from the dropdown menus in the main menubar. The following sections detail the contents of each of these menus.
</p>
<h3 id="file_menu">File</h3>
<h4>Open</h4>
<p>Select one or more models to load into the main viewer.</p>
<h4>Open Dir</h4>
<p>Select a directory from which to open all models stored within it (check memory limitations!).</p>
<h4>Save</h4>
<p>Save the currently selected model at its current file location.</p>
<h4>Save As</h4>
<p>Save the currently selected model under a different file name/location. Save models in the 3DF file format to retain the metadata Cliniface needs for its analysis. See <a href="fileformats.html#ff_3df">here</a> for more information on the 3DF file format.</p>
<h4>Import Metadata</h4>
<p>Import metadata in XML or JSON format and overwrite the currently selected model's metadata with it. See <a href="fileformats.html#element_definitions">here</a> for more information on the metadata import/export format.</p>
<h4>Export Metadata</h4>
<p>Export metadata from the currently selected model to either XML or JSON format. See <a href="fileformats.html#element_definitions">here</a> for more information on the metadata import/export format.</p>
<h4>Undo</h4>
<p>Undo the last action carried out.</p>
<h4>Redo</h4>
<p>Redo the last action carried out.</p>
<h4>Assessment Information</h4>
<p>Open the Assessment Information dialog box where subject demographic data and assessment information can be entered. Demographic data about the currently selected model is necessary for Cliniface to be able to perform an accurate analysis of the facial measurements.</p>
<h4>Model Properties</h4>
<p>Brings up summary information about the geometry of the selected model.</p>
<h4>Create Template Report</h4>
<p>Opens the PDF report template selection dialog to choose a report to generate for the selected model.</p>
<h4>Close</h4>
<p>Close the currently selected model.</p>
<h4>Close All</h4>
<p>Close all models currently open in Cliniface.</p>
<h4>Quit</h4>
<p>Close all models and shutdown Cliniface.</p>

<h3 id="view_menu">View</h3>
<h4>Texture</h4>
<p>Toggle texture mapping on and off.</p>
<h4>Wireframe</h4>
<p>Toggle triangle outlines (wireframe) on and off.</p>
<h4>Outlines</h4>
<p>Toggle manifold outlines on and off.</p>
<h4>Show Landmarks</h4>
<p>Toggle the visualisation of landmarks on and off (turns on automatically after successfull face detection).</p>
<h4>Show Custom Distances</h4>
<p>Toggle the visualisation of manually created distance measurements on and off.</p>
<h4 id="radial_select">Select Radial Area</h4>
<p>Interactively select a region around a point. Use in combination with the <a href="#cropping_tool">cropping tool</a> to remove entraneous regions of the model. Click and drag the centre handle to move the region around the model and use forwards and backwards on the mouse wheel to change the radial size of the region.</p>
<h4>Polygon Labels</h4>
<p>Turn on and off the individual polygon identifiers (useful when debugging plugins).</p>
<h4>Vertex Labels</h4>
<p>Turn on and off the individual vertex identifiers (useful when debugging plugins).</p>
<h4>Backface Culling</h4>
<p>When turned on, the inside facing surface of the model is not rendered. This is switched on automatically after automatically detecting the face. In some cases, the inside and outside surfaces of a model are incorrectly defined due to the ordering of vertices for each triangle. In this case Cliniface's <a href="geometry.html#normal_flipping">polygon normal inversion</a> tool can be used to swap the inside with the outside surface of the model.</p>
<h4>Show World Axes</h4>
<p>The scene axes grid is useful for helping to orient models so is on by default.</p>
<h4>Take Screenshot (All Viewers)</h4>
<p>Like what you see? Take a screenshot directly of the viewer and save for later use. If the left and right viewers are in use, the images across the displayed viewers will be horizontally concatenated into a single image prior to saving.</p>
<h4>Show 3D (Red/Blue)</h4>
<p>Toggle anaglyphic 3D rendering on and off. This requires the user to wear red/blue anaglyph glasses. Texture information is obviously corrupted while this rendering mode is on.</p>
<h4>Visualisations Toolbar</h4>
<p>Toggle the visualisations toolbar on and off. Removing it provides more space for the rendering viewer.</p>

<h3 id="scalar_mapping">Scalar Mapping (View sub-menu)</h3>
<h4>Show Scalar Legend</h4>
<p>Toggle the legend on and off when visualising scalar mappings of the model's surface.</p>
<h4>Minimum Colour for Scalar Visualisations</h4>
<p>Select a different colour representing the minimum value for scalar surface mappings.</p>
<h4>Maximum Colour for Scalar Visualisations</h4>
<p>Select a different colour representing the maximum value for scalar surface mappings.</p>
<h4>Mean Curvature</h4>
<p>Map scalar values to the surface visualising the average curvature around each polygon. This is an average of the curvatures at each triangle's three vertices inversely weighted by the proportional areas of adjacent triangles. Negative values are convex and positive values are concave. The sign of the curvature depends upon the orientation of the surface normals.</p>
<h4>Greatest Curvature</h4>
<p>The absolute value of the mean curvature.</p>
<h4>Asymmetry</h4>
<p>The relative difference between the two halves of the face (as split by the midsagittal plane). If no landmarks are present, asymmetry is measured between the halves of the model split by the YZ plane. The basic calculation looks at every point (vertex) on the face and maps its reflected point in the other half. Half the difference of this reflected point to its closest point on the surface is the magnitude of difference with the "pseudo" mean face, with the sign of this magnitude indicating if the original point is relatively tumid (positive) or shrunken (negative).</p>

<h3 id="camera_menu">Camera</h3>
<h4>Reset Camera</h4>
<p>Resets the position of the camera to be at a point along the positive Z axis, but focused on the centre of the currently selected model's bounding box.</p>
<h4>Orient Camera to Left Face</h4>
<p>If the currently selected model has landmarks, this places the camera to show the upright right profile of the subject's face (left side as the assessor/user sees it) with the camera focused on the mean of the landmarks. If no landmarks are present, the camera is reset to to a point along the -X axis with view vector along the +X axis.</p>
<h4>Orient Camera to Front Face</h4>
<p>As Orient Camera to Left Face but for the frontal aspect of the face.</p>
<h4>Orient Camera to Right Face</h4>
<p>As Orient Camera to Left Face but for the right profile of the face.</p>
<h4>Show Orthographic Projection</h4>
<p>Toggles rendering using orthographic projection on and off. By default, perspective projection is used. With orthographic projection on, parallel lines do not appear to converge in the distance. This allows for an accurate comparison of the sizes of different parts of a model regardless of how far apart the model parts are from one another.</p>
<h4>Synchronise Cameras</h4>
<p>With more than one viewer open and this option on, camera interactions in one viewer will be replicated across the other viewers.</p>
<h4>Auto-Rotate Views</h4>
<p>Sets the cameras in the open viewers to automatically rotate and pan about their current foci. Useful for presentations. Moving the camera again in any of the viewers will turn this mode off.</p>

<h3 id="transform_menu">Transform</h3>
<p>The functions in this menu relate to affine transformations of the selected model. For non-affine transformations, see the <a href="#geometry_menu">Geometry</a> menu.</p>
<h4>Rigid Landmark Alignment</h4>
<p>Only available if there is more than one model with landmarks in the viewer of the currently selected model. This aligns the non-selected models in the viewer to the selected model using corresponding landmarks.</p>
<h4>Rigid Vertex Correspondence</h4>
<p>Only available if there is more than one model in the viewer of the currently selected model. This finds the vertex identifiers on the non-selected models that are on the selected model, and performs a rigid correspondence in terms of these vertices. It is not necessary for models to have the same number of vertices.</p>
<h4>Rigid Vertex ICP Alignment</h4>
<p>Only available if there is more than one model in the viewer of the currently selected model. This uses ICP alignment to bring the non-selected models into alignment with the selected model by reducing the sum of square differences between pairs of vertices. The pairs of vertices being brought into alignment may have different identifiers.</p>
<h4>Transform to Standard Position</h4>
<p>Uses the landmarks on the selected model to reorient and reposition the model to be upright at the centre of the coordinate system with facial norm pointing out along the positive Z axis. Without landmarks, this function restores the model to its original (last saved) position.</p>
<h4>Recentre Model</h4>
<p>Places the centre of the selected model's bounding box at the centre of the coordinate system. Does not change the model's orientation.</p>
<h4>Rotate 90 degrees about X</h4>
<p>Rotates the model anti-clockwise around the X axis by a quarter turn. If landmarks are present defining the facial orientation, the rotation is with respect to the model's <em>local X axis</em> which is defined as the cross product of the local +Y with +Z axis (with +Y pointing up along the face's longitudinal axis and +Z at right angles to +Y pointing out from the face parallel to the face's sagittal axis).</p>
<h4>Rotate 90 degrees about Y</h4>
<p>As above but with respect to the Y axis.</p>
<h4>Rotate 90 degrees about Z</h4>
<p>As above but with respect to the Z axis.</p>
<h4>Reflect</h4>
<p>If the currently selected model has no landmarks present, the model is reflected through the YZ plane. With landmarks, the model is reflected through the midsagittal (median) plane.</p>
<h4>Rescale</h4>
<p>Brings up the rescaling dialog to resize the different dimensions of the selected model.</p>
<h4>Move Model</h4>
<p>Enters model movement interaction mode (as opposed to the default camera movement interaction mode). Clicking off the surface of the model restores camera movement interaction mode.</p>

<h3 id="geometry_menu">Geometry</h3>
<p>The functions in this menu deal in actions that make changes to the underlying geometry of the model.</p>
<h4>Invert Polygon Normals</h4>
<p>Changes the ordering of vertices for the individual triangles of the selected model so that each triangles normal vector is flipped to point in the opposite direction. Use this to swap the current inside with the current outside surface of the model.</p>
<h4>Fill Holes</h4>
<p>Detects and fills holes in the surface of the model. Holes are filled naively as a plane of triangles - i.e. local curvature around the edge of holes is not considered. More useful for filling in a few missing polygons than large swathes of the model surface.</p>
<h4>Smooth Sharp Edges/Corners</h4>
<p>Iteratively applies a smoothing function to vertices having the highest curvature to move them toward their adjacent vertices. The threshold for acceptible curvature is set high enough to prevent the facial surface from being smoothed so greatly that feature definition is corrupted.</p>
<h4 id="cropping_tool">Crop Region</h4>
<p>Use after selecting a region with the <a href="#radial_select">radial selection tool</a> to remove the parts of the model falling outside of the defined region.</p>
<h4>Create Left Symmetric Face</h4>
<p>Take the left side of the face (as seen by the user), reflect a copy of it, and use this as the new right side. Creates a perfectly symmetric face through the midsagittal plane. If the face has no landmarks, the YZ plane is used as the reflecting plane instead.</p>
<h4>Create Right Symmetric Face</h4>
<p>As above but for the right half of the face (as seen by the user).</p>
<h4>Non-Rigid Surface Registration</h4>
<p>Not available in version 4.0.0 - currently under development.</p>

<h3 id="metrics_menu">Metrics</h3>
<h4>Detect Facial Landmarks</h4>
<p>Performs automatic facial landmark detection and placement on the selected model. If landmarks are already present, the user will be asked if they want to overwrite them with new landmark positions.</p>
<h4>Remove Facial Landmarks</h4>
<p>Removes the current set of facial landmarks from the selected model. If the selected model has multiple assessments, this only removes the landmarks for the current assessment.</p>
<h4>Show Metrics</h4>
<p>Displays the facial <a href="metrics.html">metrics dialog</a> and shows the measurement locations on the selected model (if landmarks are present).</p>

<h3 id="help_menu">Help</h3>
<h4>Help</h4>
<p>Opens the inbuilt help browser to display the offline version of this documentation (which you might be reading right now).</p>
<h4>What's This?</h4>
<p>Click this option, then click anywhere in the user interface where the icon turns into a question mark to display detailed help text about the feature.</p>
<h4>Preferences</h4>
<p>Displays the <a href="preferences.html">preferences</a> dialog for making configuration changes to Cliniface's behaviour.</p>
<h4>Plugins</h4>
<p>Displays a dialog box showing the plugins that Cliniface has loaded.</p>
<h4>About</h4>
<p>Displays some summary information about the Cliniface platform.</p>

<h2 id="main_toolbar">Main Toolbar</h2>
<p>The main toolbar provides a shortcut to a subset of the more commonly used actions that are also available via the menus. From left to right, these actions are:
</p>
<ul>
    <li>Open file</li>
    <li>Save file</li>
    <li>Show assessment information</li>
    <li>Generate a template report</li>
    <li>Undo the last action</li>
    <li>Redo the last action</li>
    <li>(Re)Detect facial landmarks</li>
    <li>Fill holes</li>
    <li>Smooth surface</li>
    <li>Crop selected region</li>
    <li>Align other models in the viewer to the selected model using corresponding landmarks</li>
    <li>Transform the selected model to standard position</li>
    <li>Centre the selected model at the view coordinates centre (0,0,0)</li>
    <li>Centre the selected model at the view coordinates centre (0,0,0)</li>
    <li>Rotate the selected model 90 degrees anti-clockwise about the X axis</li>
    <li>Rotate the selected model 90 degrees anti-clockwise about the Y axis</li>
    <li>Rotate the selected model 90 degrees anti-clockwise about the Z axis</li>
    <li>Reflect the selected model through the midsagittal plane</li>
    <li>Resize the selected model</li>
    <li>Toggle model movement mode on/off</li>
    <li>Reset the camera</li>
    <li>Show the subject's right profile (left side of the face)</li>
    <li>Show the subject's front profile</li>
    <li>Show the subject's left profile (right side of the face)</li>
    <li>Toggle orthographic projection mode on/off</li>
    <li>Toggle locked camera interaction mode across viewers on/off</li>
    <li>The Cliniface logo takes you out to the website</li>
</ul>

<h2 id="vis_toolbar">Visualisations Toolbar</h2>
<p>The visualisations toolbar provides shortcuts to common actions that alter the visual appearance of models. This toolbar also contains some "spinner" widgets which incrementally vary the model's appearance in different ways; these are discussed in more detail below. From left to right, the actions available from the visualisations toolbar are:
</p>
<ul>
    <li>Toggle texture map on/off</li>
    <li>Toggle wireframe on/off</li>
    <li>Toggle manifold boundary outlines on/off</li>
    <li>Toggle landmarks (if present) on/off</li>
    <li>Toggle metric visualisations on/off (also shows/hides the metrics dialog)</li>
    <li>Toggle display of custom measurements on/off</li>
    <li>Toggle radial selection widget on/off</li>
    <li>Toggle backface culling on/off</li>
    <li>Spinner to set the model's surface opacity</li>
    <p>This value can be changed from 0 (fully transparent) to 1 (fully opaque). It can be useful to adjust the opacity of the model's surface when several models overlap in the same viewer so that all of the overlapping surfaces can be seen at once.</p>
    <li>Toggle world axes (viewer coordinate box) on/off</li>
    <li>Spinner to set the minimum scalar mapping value</li>
    <li>Spinner to Set the maximum scalar mapping value</li>
    <p>The above two spinner widgets set the minimum and maximum values within the range of allowed values for the currently selected scalar mapping visualisation. They can be used to zoom in or out on a subset of the range of mapped values to more easily ascertain variance over that range. The widgets are inactive if no scalar mapping visualisation is currently shown.</p>
    <li>Spinner to set the number of colour bands to use for scalar mapping visualisations</li>
    <p>Changing the number of colour bands for a scalar visualisation is analagous to changing the resolution of the scalar mapping. By setting this value (together with setting the minimum and maximum scalar mapping values) and paying attention to the position of the colour bands in the scalar visualisation legend, this can be useful to more easily ascertain which parts of the model map to certain values. For example, setting this value to 2 allows one to easily see where on the model a particular threshold value is crossed for the current scalar mapping visualisation.</p>
    <li>Toggle the mean curvature scalar mapping visualisation on/off</li>
    <li>Toggle the greatest curvature scalar mapping visualisation on/off</li>
    <li>Toggle the asymmetry scalar mapping visualisation on/off</li>
</ul>

<h2 id="main_viewer">Main Viewer</h2>
<p>The main viewer is where loaded models are rendered. Use the mouse to interact with the camera or models in this viewer. See the <a href="tutorial.html#image_selecting">tutorial</a> for information on basic camera/model interactions using the mouse. There are three separate viewers that may be open at once - initially only the centre viewer is shown. Models can be moved into the viewers to the left or right of the central viewer. Click the right mouse button on a model in the viewer to show the context menu.
</p>
<h3 id="context_menu">Context Menu</h3>
<p>Right clicking on a model will bring up the context menu. From here, there are several actions that can be selected which depend upon the position of the mouse cursor at the time of clicking.</p>
<h4>Set Camera Focus</h4>
<p>Sets the focus of the camera to the pointed at location on the model's surface. The <em>F</em> key can also be pressed to do this without opening the context menu.</p>
<h4>Add Distance Measure</h4>
<p>Start drawing a path between two points on the surface of the model. The caliper (straight line) distance between the points is shown while dragging one of the path's endpoints, and both the caliper and surface distance is shown in the bottom right corner of the viewer. The path that is drawn follows a local curvature minimising path between the two points. If a surface path cannot be drawn (due to high curvature parts of the face or if the path endpoints are on disconnected parts of the model), a straight line between the points will be shown instead.</p>
<h4>Rename Distance Measure</h4>
<p>Added distance measurements can be given a name to distinguish them when exporting data from Cliniface.</p>
<h4>Delete Distance Measure</h4>
<p>Deletes the distance measurement underneath the cursor.</p>
<h4>Select Radial Area</h4>
<p>Choosing this action from the <a href="#radial_select">menu</a> or toolbar will place the centre of the radial area at the nose-tip (if there are landmarks present). Selecting this action from the context menu places the centre handle under the cursor.</p>
<h4>Discard Manifold Under Cursor</h4>
<p>Remove the model manifold under the cursor.</p>
<h4>Discard Manifolds NOT Under Cursor</h4>
<p>Retain only the single manifold under the cursor - discarding all other manifolds.</p>


<h2 id="selection">Model / View Selection</h2>
<p>These widgets provide the user with the means to select models without clicking on them in the main viewer, and to create copies of views of models and to move these views to adjacent viewers.
</p>
<p>The two buttons with block arrows at the outside edges of this region of the interface are the model movement actions. Pressing these buttons moves the currently selected model into the viewers to the left or right of the viewer they appear under. If there is no movement button shown, the selected model is already in the left or right viewer. If the selected model being moved is a copy and is being moved into a viewer holding another copy of the model, the copy in the target viewer will be removed and the copy being moved in will take its place.
</p>
<p>Just inside the movement buttons, are the copy buttons. These make a copy of the currently selected model and place its view copy into the corresponding viewer to the left or right of the selected model. If the copy button is not present, the selected model is already in the left or right viewer. If the copy button is greyed out (unavailable) then there is already a copy of the model present in the corresponding viewer - use the movement button to merge the copy back if desired.
</p>
<p>In the centre of this region of the interface is a dropdown list showing the models present in the viewer. Each viewer has its own dropdown list showing just the models being rendered in that viewer. Selecting an entry from this list will select that model and if configured to do so, Cliniface will move the camera to look at the selected model.
</p>

<h2 id="status_bar">Status Bar</h2>
<p>This shows information to the user about the current action being performed.
</p>

<br>
<hr>
<center>
<a href="#_top">Back to top</a><br>
<a href="index.html">Back to contents</a>
<strong><p>&copy; 2018/2019 Spatial Information Systems Research Limited &amp; Richard Palmer</p></strong>
</center>

</body>
</html>
